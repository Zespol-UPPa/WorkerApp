<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<AnchorPane prefHeight="700.0" prefWidth="500.0" style="-fx-background-color: #2C3E50;"
            xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="parkflow.deskoptworker.Controllers.ActivationController">

    <!-- Main Container -->
    <VBox alignment="CENTER" spacing="20.0" AnchorPane.bottomAnchor="30.0"
          AnchorPane.leftAnchor="30.0" AnchorPane.rightAnchor="30.0" AnchorPane.topAnchor="30.0">

        <!-- Header -->
        <Label text="Account Activation" textFill="WHITE">
            <font>
                <Font name="System Bold" size="24.0"/>
            </font>
        </Label>

        <!-- ===== STEP 1: Code Entry ===== -->
        <VBox fx:id="codeEntryPane" alignment="CENTER" spacing="15.0"
              style="-fx-background-color: #34495E; -fx-background-radius: 10;">
            <padding>
                <Insets bottom="30.0" left="30.0" right="30.0" top="30.0"/>
            </padding>

            <Label text="Enter Activation Code" textFill="WHITE">
                <font>
                    <Font size="16.0"/>
                </font>
            </Label>

            <TextField fx:id="codeTextField" promptText="LC-XX-XXXXXX" style="-fx-font-size: 14px;">
                <VBox.margin>
                    <Insets top="10.0"/>
                </VBox.margin>
            </TextField>

            <Label fx:id="codeErrorLabel" textFill="#E74C3C" wrapText="true" visible="false" managed="false"/>

            <Button fx:id="verifyCodeButton" mnemonicParsing="false" onAction="#handleVerifyCode"
                    prefWidth="200.0" style="-fx-background-color: #3498DB; -fx-text-fill: white; -fx-font-size: 14px;"
                    text="Verify Code">
                <VBox.margin>
                    <Insets top="10.0"/>
                </VBox.margin>
            </Button>
        </VBox>

        <!-- ===== STEP 2: Data Confirmation & Password Setup ===== -->
        <ScrollPane fx:id="dataEntryPane" fitToWidth="true"
                    style="-fx-background: transparent; -fx-background-color: transparent;"
                    visible="false" managed="false">
            <VBox spacing="15.0" style="-fx-background-color: #34495E; -fx-background-radius: 10;">
                <padding>
                    <Insets bottom="30.0" left="30.0" right="30.0" top="30.0"/>
                </padding>

                <!-- Account Info Header -->
                <Label text="Confirm Your Information" textFill="WHITE">
                    <font>
                        <Font name="System Bold" size="16.0"/>
                    </font>
                </Label>

                <Label text="Please verify and update your information if needed:"
                       textFill="#BDC3C7" wrapText="true">
                    <font>
                        <Font size="12.0"/>
                    </font>
                </Label>

                <Separator style="-fx-background-color: #7F8C8D;"/>

                <!-- Account ID (Read-only) - IMPORTANT FOR LOGIN -->
                <VBox spacing="5.0">
                    <Label text="Your Login ID" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <TextField fx:id="accountIdField" editable="false"
                               style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-background-color: #27AE60; -fx-text-fill: white;"/>
                    <Label text="⚠️ Save this ID - you will need it to log in!" textFill="#E67E22" wrapText="true">
                        <font>
                            <Font size="11.0"/>
                        </font>
                    </Label>
                </VBox>

                <!-- Email (Read-only) -->
                <VBox spacing="5.0">
                    <Label text="Email" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <TextField fx:id="emailField" editable="false"
                               style="-fx-font-size: 14px; -fx-background-color: #2C3E50; -fx-text-fill: #BDC3C7;"/>
                </VBox>

                <!-- First Name (Editable) -->
                <VBox spacing="5.0">
                    <Label text="First Name *" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <TextField fx:id="firstNameField" style="-fx-font-size: 14px;"/>
                </VBox>

                <!-- Last Name (Editable) -->
                <VBox spacing="5.0">
                    <Label text="Last Name *" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <TextField fx:id="lastNameField" style="-fx-font-size: 14px;"/>
                </VBox>

                <!-- Phone (Editable) -->
                <VBox spacing="5.0">
                    <Label text="Phone Number *" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <TextField fx:id="phoneField" style="-fx-font-size: 14px;"/>
                </VBox>

                <!-- PESEL (Editable) -->
                <VBox spacing="5.0">
                    <Label text="PESEL *" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <TextField fx:id="peselField" style="-fx-font-size: 14px;"/>
                </VBox>

                <!-- Role (Read-only) -->
                <VBox spacing="5.0">
                    <Label text="Role" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <TextField fx:id="roleField" editable="false"
                               style="-fx-font-size: 14px; -fx-background-color: #2C3E50; -fx-text-fill: #BDC3C7;"/>
                </VBox>

                <!-- Parking (Read-only, visible only for Worker) -->
                <VBox fx:id="parkingPane" spacing="5.0" visible="false" managed="false">
                    <Label text="Assigned Parking" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <TextField fx:id="parkingField" editable="false"
                               style="-fx-font-size: 14px; -fx-background-color: #2C3E50; -fx-text-fill: #BDC3C7;"/>
                </VBox>

                <!-- Company (Read-only, visible only for Admin) -->
                <VBox fx:id="companyPane" spacing="5.0" visible="false" managed="false">
                    <Label text="Company" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <TextField fx:id="companyField" editable="false"
                               style="-fx-font-size: 14px; -fx-background-color: #2C3E50; -fx-text-fill: #BDC3C7;"/>
                </VBox>

                <Separator style="-fx-background-color: #7F8C8D;">
                    <VBox.margin>
                        <Insets bottom="5.0" top="5.0"/>
                    </VBox.margin>
                </Separator>

                <!-- Password Setup -->
                <Label text="Set Your Password" textFill="WHITE">
                    <font>
                        <Font name="System Bold" size="16.0"/>
                    </font>
                </Label>

                <VBox spacing="5.0">
                    <Label text="Password *" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <PasswordField fx:id="passwordField" promptText="Minimum 8 characters"
                                   style="-fx-font-size: 14px;"/>
                </VBox>

                <VBox spacing="5.0">
                    <Label text="Confirm Password *" textFill="#BDC3C7">
                        <font>
                            <Font name="System Bold" size="12.0"/>
                        </font>
                    </Label>
                    <PasswordField fx:id="confirmPasswordField" promptText="Re-enter password"
                                   style="-fx-font-size: 14px;"/>
                </VBox>

                <!-- Error Label -->
                <Label fx:id="dataErrorLabel" textFill="#E74C3C" wrapText="true" visible="false" managed="false">
                    <VBox.margin>
                        <Insets top="5.0"/>
                    </VBox.margin>
                </Label>

                <!-- Buttons -->
                <HBox alignment="CENTER" spacing="15.0">
                    <VBox.margin>
                        <Insets top="15.0"/>
                    </VBox.margin>

                    <Button fx:id="backButton" mnemonicParsing="false" onAction="#handleBack"
                            prefWidth="150.0" style="-fx-background-color: #95A5A6; -fx-text-fill: white; -fx-font-size: 14px;"
                            text="Back"/>

                    <Button fx:id="activateButton" mnemonicParsing="false" onAction="#handleActivate"
                            prefWidth="150.0" style="-fx-background-color: #27AE60; -fx-text-fill: white; -fx-font-size: 14px;"
                            text="Activate Account"/>
                </HBox>
            </VBox>
        </ScrollPane>

        <!-- Back to Login -->
        <Label text="Back to Login" textFill="#3498DB" underline="true"
               onMouseClicked="#handleBackToLogin" style="-fx-cursor: hand;">
            <VBox.margin>
                <Insets top="10.0"/>
            </VBox.margin>
        </Label>

    </VBox>
</AnchorPane>
